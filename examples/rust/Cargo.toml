[package]
name = "mavspec_examples_rust"
description = "Example crate with sources autogenerated by MAVSpec"
version = "0.0.0"
edition = "2021"
authors = ["Mykhailo Ziatin <ziatin@mathwithoutend.org>"]
readme = "README.md"
resolver = "2"
publish = false

[lib]
name = "mavspec_examples_rust"
path = "src/lib.rs"

[[bin]]
name = "mavspec_examples_rust"
path = "src/bin/mavspec_examples_rust.rs"
test = true

###########################################################
# Dependencies
###########################################################
[dependencies]
# MAVSpec: enable `rust` feature to import Rust interfaces.
mavspec = { path = "../../mavspec", default-features = false, features = ["rust"] }

# Logging
log = "0.4.20"
env_logger = "0.11.0"

# Serde support: we need to include both `serde` and `serde_arrays`.
serde = { version = "1.0.193", default-features = false, features = ["derive"], optional = true }
serde_arrays = { version = "0.1.0", default-features = false, optional = true }

[build-dependencies]
# MAVSpec: enable `rust_gen` feature to include Rust code-generation tools.
mavspec = { path = "../../mavspec", features = ["rust_gen"] }

###########################################################
# Features
###########################################################
[features]
## Default features
default = ["minimal", "mav_inspect_test"]
## Enables serde support.
serde = [
    "dep:serde",
    "dep:serde_arrays",
]
# Enable global allocator
alloc = ["mavspec/alloc"]
# Enable Rust standard library
std = ["alloc", "mavspec/std"]

###########################################################
# Dialects
###########################################################
## Include `common` dialect
common = ["minimal"]
## Include custom `MAVInspect_test` dialect
mav_inspect_test = ['standard']
## Include `minimal` dialect
minimal = []
## Include `standard` dialect
standard = ["minimal"]

###########################################################
# Metadata
###########################################################
[package.metadata.mavspec]
# MAVLink microservices to include
microservices = ["HEARTBEAT", "FTP"]
# Inclide only the following messages (in addition to those required by `microservices`)
messages = ["PROTOCOL_VERSION", "MAV_INSPECT_V1"]
# Inclide only the following commands (in addition to those required by `microservices`)
commands = ["MAV_CMD_DO_CHANGE_SPEED", "MAV_CMD_DO_SET_ROI*"]
# Inclide only the following enums (in addition to those required by `microservices` and `commands`)
enums = ["STORAGE_STATUS", "GIMBAL_*"]
# Generate tests
generate_tests = true

[package.metadata.cargo-machete]
ignored = ["mavspec", "serde", "serde_arrays"]
